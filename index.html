<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Family Daily Routine</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #ffffff;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 1rem;
            color: #be185d;
        }
        .main-container {
            display: flex;
            background-color: #ffffff;
            border-radius: 1.5rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            max-width: 7xl;
            min-height: 80vh;
            overflow: hidden;
            transition: background-color 0.5s ease-in-out;
        }
        /* Styles specific to the Dad's routine */
        .dad-theme {
            background-color: #dbeafe;
        }
        .dad-theme .sidebar {
            background-color: #dbeafe;
            border-right: 2px solid #93c5fd;
        }
        .dad-theme h1, .dad-theme h2, .dad-theme li {
            color: #1e40af;
        }
        .dad-theme li.completed {
            color: #93c5fd;
        }
        .dad-theme .done-button {
            background-color: #22c55e;
        }
        .dad-theme .done-button:hover {
            background-color: #16a34a;
        }

        /* Styles specific to the Kids' routine */
        .kids-theme {
            background-color: #fbcfe8;
        }
        .kids-theme .sidebar {
            background-color: #fbcfe8;
            border-right: 2px solid #f9a8d4;
        }
        .kids-theme h1, .kids-theme h2, .kids-theme li {
            color: #be185d;
        }
        .kids-theme li.completed {
            color: #f9a8d4;
        }
        .kids-theme .done-button {
            background-color: #ec4899;
        }
        .kids-theme .done-button:hover {
            background-color: #db2777;
        }

        .sidebar {
            padding: 2.5rem;
            width: 35%;
        }
        .main-content {
            flex-grow: 1;
            padding: 2.5rem;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }
        h2 {
            font-size: 1.75rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }
        ul {
            list-style: none;
            padding: 0;
            text-align: left;
        }
        li {
            font-size: 1.125rem;
            font-weight: 500;
            padding: 0.5rem 0;
            transition: text-decoration 0.3s ease-in-out, opacity 0.3s ease-in-out;
        }
        li.completed {
            text-decoration: line-through;
            opacity: 0.7;
        }
        .current-task {
            animation: fadeIn 0.5s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .task-text {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 2rem;
        }
        .done-button {
            color: white;
            padding: 1rem 2.5rem;
            border-radius: 9999px;
            font-weight: 700;
            transition: background-color 0.2s ease-in-out, transform 0.2s ease-in-out;
            cursor: pointer;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }
        #tv-break-section {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            flex-grow: 1;
            background-color: #fef3c7;
        }
        .tv-break-message {
            font-size: 4rem;
            font-weight: 800;
            color: #f97316;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
            animation: bounce 1s infinite, color-change 2s infinite;
        }
        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-20px); }
        }
        @keyframes color-change {
            0% { color: #f97316; }
            33% { color: #3b82f6; }
            66% { color: #16a34a; }
            100% { color: #f97316; }
        }
        .emoji-container {
            font-size: 5rem;
            margin-top: 1.5rem;
            animation: pulse 1s infinite;
        }
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }
        /* Confetti animation */
        @keyframes confetti-fall {
            0% { transform: translateY(-100vh) rotateZ(0deg); opacity: 1; }
            100% { transform: translateY(100vh) rotateZ(360deg); opacity: 0; }
        }
        .confetti {
            position: fixed;
            width: 10px;
            height: 10px;
            background-color: #ffcc00;
            animation-name: confetti-fall;
            animation-timing-function: linear;
            animation-duration: 5s;
            z-index: 1000;
            pointer-events: none;
            border-radius: 50%;
        }
        /* Mobile styles */
        @media (max-width: 768px) {
            .main-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                border-right: none;
                border-bottom: 2px solid #93c5fd;
            }
            .main-content {
                padding: 1.5rem;
            }
        }

        #routine-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            text-align: center;
            width: 100%;
            height: 100vh;
        }
        #menu-buttons {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 2rem;
            margin-top: 2rem;
        }
        @media (min-width: 768px) {
            #menu-buttons {
                flex-direction: row;
                justify-content: center;
            }
        }

        .menu-button {
            position: relative;
            background-color: #f3f4f6;
            border-radius: 1rem;
            padding: 0.5rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            width: 100%;
            max-width: 300px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
        }

        .menu-button:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 15px rgba(0,0,0,0.2);
        }
        
        .menu-button img {
            width: 100%;
            height: auto;
            object-fit: contain;
            transition: transform 0.3s ease-in-out;
            border-radius: 0.5rem;
        }
        .menu-button:hover img {
            transform: scale(1.05);
        }

        .menu-button h2 {
            position: static;
            transform: none;
            z-index: 3;
            color: #1f2937;
            text-shadow: none;
            width: auto;
            font-weight: 700;
            margin-top: 0.5rem;
        }
        
        /* New styles for the chores icon grid */
        .chores-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 2rem;
            max-width: 800px;
            margin: 2rem auto;
            width: 100%;
        }

        .chore-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
            border-radius: 1rem;
            background-color: #fce7f3; /* Light pink background */
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.15s, opacity 0.3s, background-color 0.3s;
            text-align: center;
            min-height: 120px;
        }

        .chore-icon:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 10px rgba(0,0,0,0.15);
        }

        .chore-icon.completed {
            opacity: 0.5;
            pointer-events: none;
            background-color: #f9a8d4; /* Darker pink for completed */
            color: #ffffff;
        }

        .chore-icon span {
            font-size: 3rem;
        }

        .chore-icon p {
            font-size: 0.875rem;
            font-weight: 600;
            line-height: 1.2;
            margin-top: 0.5rem;
            color: #be185d;
        }
        
        .chore-icon.completed p {
             color: #ffffff;
        }
        
        #payment-display {
            font-size: 3rem;
            font-weight: 800;
            color: #10b981; /* Green color for money */
            margin-top: 1rem;
            animation: popIn 0.3s ease-out;
            padding: 1rem;
            border-radius: 0.5rem;
            background-color: #d1fae5;
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        /* NEW MODAL STYLES */
        .modal-overlay {
            display: none; /* Hidden by default */
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 2000;
        }
        .modal-box {
            background-color: white;
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            text-align: center;
            max-width: 90%;
            width: 400px;
        }
        #modal-question {
            font-size: 1.5rem;
            font-weight: 600;
            color: #be185d;
            margin-bottom: 2rem;
        }
        .modal-options-container {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }
        .modal-option-button {
            font-size: 1.5rem;
            font-weight: 700;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: none;
            background-color: #fce7f3;
            color: #be185d;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.2s;
        }
        .modal-option-button:hover {
            background-color: #f9a8d4;
            transform: scale(1.1);
        }
        .modal-cancel-button {
            font-size: 1rem;
            font-weight: 500;
            color: #6b7280;
            background: none;
            border: none;
            cursor: pointer;
        }
        .modal-cancel-button:hover {
            text-decoration: underline;
        }


    </style>
</head>
<body>
    <div class="main-container" id="main-container">
        <div id="routine-menu">
            <h1 class="text-3xl font-bold">Choose a Routine</h1>
            <div id="menu-buttons">
                <div class="menu-button" id="dad-button">
                    <img src="alpha_lion.webp" alt="Alpha Lion">
                    <h2 class="text-xl font-bold">Dad's Morning Routine</h2>
                </div>
                <div class="menu-button" id="gentry-button">
                    <img src="unicorn.jpg" alt="Unicorn">
                    <h2 class="text-xl font-bold">Gentry's Morning Routine</h2>
                </div>
                <div class="menu-button" id="chores-button">
                    <img src="chores.jpg" alt="Cute Sparkly Rainbow Star">
                    <h2 class="text-xl font-bold">Gentry's Chores Routine</h2>
                </div>
                </div>
        </div>

        <div class="sidebar" id="sidebar-section" style="display: none;">
            <h2 id="sidebar-title"></h2>
            <ul id="checklist-list" class="space-y-2">
                </ul>
        </div>
        
        <div class="main-content" id="main-content-section" style="display: none;">
            <h1 id="main-title"></h1>
            <div id="current-task-container" class="current-task">
                </div>
        </div>
        
        <div id="tv-break-section" style="display: none;">
            <h1 class="tv-break-message">TV and BREAKFAST BREAK!!!</h1>
            <div class="emoji-container">üì∫üéâüéàü•ûüßÅ</div>
            <button id="tv-break-done-button" class="done-button mt-8">Done with TV</button>
        </div>
    </div>

    <!-- NEW MODAL HTML -->
    <div id="quantity-modal-overlay" class="modal-overlay">
        <div class="modal-box">
            <h3 id="modal-question">Question goes here</h3>
            <div id="modal-options" class="modal-options-container">
                <!-- Number buttons will be injected here by JS -->
            </div>
            <button id="modal-cancel-button" class="modal-cancel-button">Cancel</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const dadTasks = [
                "Wake up",
                "Make bed",
                "Brush Teeth/Use bathroom",
                "Make Coffee",
                "Make Lunch",
                "7-minute morning workout",
                "Get dressed",
                "Do hair",
                "Morning devotional"
            ];

            const dadQuotes = [
                { text: "A good father is one of the most unsung, unpraised, unnoticed, and yet one of the most valuable assets in our society.", source: "Billy Graham" },
                { text: "My father didn't tell me how to live; he lived, and let me watch him do it.", source: "Clarence Budington Kelland" },
                { text: "A father is a man who expects his son to be as good a man as he meant to be.", source: "Frank A. Clark" },
                { text: "The greatest mark of a father is how he treats his children when no one is looking.", source: "Dan Pearce" },
                { text: "I cannot think of any need in childhood as strong as the need for a father's protection.", source: "Sigmund Freud" },
                { text: "A father's tears and fears are unseen, his love is unexpressed, but his care and protection remains as a pillar of strength throughout our lives.", source: "Ama H. Vanniarachchy" },
                { text: "Any man can be a Father, but it takes someone special to be a dad.", source: "Anne Geddes" },
                { text: "Being a great father is like shaving. No matter how good you shaved today, you have to do it again tomorrow.", source: "Reed Markham" },
                { text: "A man never stands taller than when he kneels to help a child.", source: "Abraham Lincoln" },
                { text: "The heart of a father is the masterpiece of nature.", source: "Antoine Fran√ßois Pr√©vost" },
                { text: "The most important thing a father can do for his children is to love their mother.", source: "Theodore Hesburgh" },
                { text: "Of all the gifts a dad can give his kid, maybe the best one of all is a good example to follow.", source: "Joey Benevento" },
                { text: "A father's love is forever imprinted on his child's heart.", source: "Jennifer Williamson" },
                { text: "The father who does not teach his son his duties is equally guilty with the son who neglects them.", source: "Confucius" },
                { text: "I am a princess not because I have a prince, but because my father is a king.", source: "Unknown" },
                { text: "He was a father. That's what a father does. Eases the burdens of those he loves.", source: "J. August Strindberg" },
                { text: "A man's worth is measured by how he parents his children. What he gives them, what he keeps away from them, the lessons he teaches and the lessons he allows them to learn on their own.", source: "Lisa Rogers" },
                { text: "My father gave me the greatest gift anyone could give another person, he believed in me.", source: "Jim Valvano" },
                { text: "There's no shame in fear, my father told me, what matters is how we face it.", source: "George R.R. Martin" },
                { text: "A father is someone you look up to no matter how tall you grow.", source: "Unknown" },
                { text: "Being a father has been, without a doubt, my greatest source of achievement, pride and inspiration.", source: "Naveen Jain" },
                { text: "When I looked at you first I saw not your mother and me, but your two grandfathers.", source: "Peter Carey" },
                { text: "It is easier for a father to have children than for children to have a real father.", source: "Pope John XXIII" },
                { text: "God is our refuge and strength, a very present help in trouble.", source: "Psalm 46:1" },
                { text: "And call no man your father on earth, for you have one Father, who is in heaven.", source: "Matthew 23:9" },
                { text: "Train up a child in the way he should go; even when he is old he will not depart from it.", source: "Proverbs 22:6" },
                { text: "Be watchful, stand firm in the faith, act like men, be strong.", source: "1 Corinthians 16:13" },
                { text: "If any of you lacks wisdom, let him ask God, who gives generously to all without reproach, and it will be given him.", source: "James 1:5" },
                { text: "When my father didn't have my hand... he had my back.", source: "Linda Poindexter" },
                { text: "A father's love is a powerful compass that guides us through life's challenges.", source: "Unknown" },
                { text: "God is the archetypal Father; all other fatherhood is a more or less imperfect copy of his perfect fatherhood.", source: "F.F. Bruce" },
                { text: "The most valuable asset in our society is a good father.", source: "Billy Graham" },
                { text: "What we become depends on what our fathers teach us at odd moments, when they aren't trying to teach us. We are formed by little scraps of wisdom.", source: "Umberto Eco" },
                { text: "A man's worth is measured by how he parents his children.", source: "Lisa Rogers" },
                { text: "My father gave me the greatest gift anyone could give another person, he believed in me.", source: "Jim Valvano" },
                { text: "There's no shame in fear, my father told me, what matters is how we face it.", source: "George R.R. Martin" },
                { text: "A father's love is forever imprinted on his child's heart.", source: "Jennifer Williamson" },
                { text: "The father who does not teach his son his duties is equally guilty with the son who neglects them.", source: "Confucius" },
                { text: "I am a princess not because I have a prince, but because my father is a king.", source: "Unknown" },
                { text: "He was a father. That's what a father does. Eases the burdens of those he loves.", source: "J. August Strindberg" },
                { text: "A man's worth is measured by how he parents his children. What he gives them, what he keeps away from them, the lessons he teaches and the lessons he allows them to learn on their own.", source: "Lisa Rogers" },
                { text: "My father gave me the greatest gift anyone could give another person, he believed in me.", source: "Jim Valvano" },
                { text: "There's no shame in fear, my father told me, what matters is how we face it.", source: "George R.R. Martin" },
                { text: "A father is someone you look up to no matter how tall you grow.", source: "Unknown" },
                { text: "Being a father has been, without a doubt, my greatest source of achievement, pride and inspiration.", source: "Naveen Jain" },
                { text: "When I looked at you first I saw not your mother and me, but your two grandfathers.", source: "Peter Carey" },
                { text: "It is easier for a father to have children than for children to have a real father.", source: "Pope John XXIII" },
                { text: "God is our refuge and strength, a very present help in trouble.", source: "Psalm 46:1" },
                { text: "And call no man your father on earth, for you have one Father, who is in heaven.", source: "Matthew 23:9" },
                { text: "Train up a child in the way he should go; even when he is old he will not depart from it.", source: "Proverbs 22:6" },
                { text: "Be watchful, stand firm in the faith, act like men, be strong.", source: "1 Corinthians 16:13" },
                { text: "If any of you lacks wisdom, let him ask God, who gives generously to all without reproach, and it will be given him.", source: "James 1:5" },
                { text: "When my father didn't have my hand... he had my back.", source: "Linda Poindexter" },
                { text: "A father's love is a powerful compass that guides us through life's challenges.", source: "Unknown" }
            ];
            
            const kidsTasks = [
                { text: "Wake up", emoji: "‚òÄÔ∏è" },
                { text: "Use the potty/bathroom", emoji: "üöΩ" },
                { text: "Wash hands", emoji: "üëè"},
                { text: "Brush teeth", emoji: "ü¶∑" },
                { text: "Comb hair", emoji: "üíá‚Äç‚ôÄÔ∏è" },
                { text: "Make bed", emoji: "üõèÔ∏è"},
                { text: "Get dressed", emoji: "üëï" },
                { text: "Take medicine", emoji: "üíä" },
                { text: "Put on shoes", emoji: "üëü" },
                { text: "Grab backpack", emoji: "üéí" }
            ];

            const choresTasks = [
                { 
                    text: "Wipe Down Bathroom Counter", 
                    emoji: "üßΩ", 
                    amount: 0.75,
                    isQuantifiable: true,
                    question: "How many bathroom counters wiped?",
                    options: [1, 2] 
                },
                { 
                    text: "Clean Toilet", 
                    emoji: "üöΩ", 
                    amount: 0.75,
                    isQuantifiable: true,
                    question: "How many toilets cleaned?",
                    options: [1, 2] 
                },
                { 
                    text: "Vacuum", 
                    emoji: "üßπ", 
                    amount: 0.50,
                    isQuantifiable: true,
                    question: "How many areas vacuumed?",
                    options: [1, 2, 3, 4] 
                },
                { 
                    text: "Trashes", 
                    emoji: "üóëÔ∏è", 
                    amount: 0.50,
                    isQuantifiable: true,
                    question: "How many trashes emptied?",
                    options: [1, 2, 3, 4] 
                },
                { text: "Clean out car", emoji: "üöó", amount: 0.75, isQuantifiable: false },
                { text: "Dusting", emoji: "‚ú®", amount: 0.75, isQuantifiable: false },
                { text: "Clean the shoe rack", emoji: "üëü", amount: 0.75, isQuantifiable: false },
                { text: "Load/unload dishwasher", emoji: "üçΩÔ∏è", amount: 0.50, isQuantifiable: false }
            ];

            const kidsQuotes = [
                { text: "You're off to great places! Today is your day!", source: "Dr. Seuss" },
                { text: "Be silly, be honest, be kind.", source: "Ralph Waldo Emerson" },
                { text: "The best way to cheer yourself up is to try to cheer somebody else up.", source: "Mark Twain" },
                { text: "Always be a little kinder than necessary.", source: "J.M. Barrie" },
                { text: "The more you read, the more things you will know. The more that you learn, the more places you'll go.", source: "Dr. Seuss" },
                { text: "Today a reader, tomorrow a leader.", source: "Margaret Fuller" },
                { text: "How wonderful it is that nobody need wait a single moment before starting to improve the world.", source: "Anne Frank" },
                { text: "Happiness can be found, even in the darkest of times, if one only remembers to turn on the light.", source: "Albus Dumbledore" },
                { text: "You have a brain in your head. You have feet in your shoes. You can steer yourself any direction you choose.", source: "Dr. Seuss" },
                { text: "Never give up on what you really want to do. The person with big dreams is more powerful than one with all the facts.", source: "H. Jackson Brown, Jr." },
                { text: "The future belongs to those who believe in the beauty of their dreams.", source: "Eleanor Roosevelt" },
                { text: "You can steer yourself in any direction you choose.", source: "Dr. Seuss" },
                { text: "The world is full of magical things patiently waiting for our wits to grow sharper.", source: "Bertrand Russell" },
                { text: "Believe you can and you're halfway there.", source: "Theodore Roosevelt" },
                { text: "Kindness is a language which the deaf can hear and the blind can see.", source: "Mark Twain" },
                { text: "The secret of getting ahead is getting started.", source: "Mark Twain" },
                { text: "You're braver than you believe, and stronger than you seem, and smarter than you think.", source: "A.A. Milne" },
                { text: "There is no limit to what you can do.", source: "Maya Angelou" },
                { text: "Try to be a rainbow in someone's cloud.", source: "Maya Angelou" },
                { text: "The only person you should try to be better than is the person you were yesterday.", source: "Unknown" },
                { text: "Just keep swimming.", source: "Dory, Finding Nemo" },
                { text: "We all can dance when we find music we love.", source: "Giles Andreae" },
                { text: "If you can dream it, you can do it.", source: "Walt Disney" },
                { text: "Don't just fly, soar.", source: "Dumbo" },
                { text: "The only thing that is constant is change.", source: "Heraclitus" }
            ];
            
            let currentTaskIndex = 0;
            let currentRoutine = null;
            let quoteShown = false;
            let completedChoreCount = 0; 

            const mainContainer = document.getElementById('main-container');
            const menuSection = document.getElementById('routine-menu');
            const dadButton = document.getElementById('dad-button');
            const gentryButton = document.getElementById('gentry-button');
            const choresButton = document.getElementById('chores-button');
            const sidebarSection = document.getElementById('sidebar-section');
            const checklistListEl = document.getElementById('checklist-list');
            const mainTitleEl = document.getElementById('main-title');
            const sidebarTitleEl = document.getElementById('sidebar-title');
            const currentTaskContainerEl = document.getElementById('current-task-container');
            const mainContentSection = document.getElementById('main-content-section');
            const tvBreakSectionEl = document.getElementById('tv-break-section');
            const tvBreakDoneButton = document.getElementById('tv-break-done-button');
            const modalOverlay = document.getElementById('quantity-modal-overlay');
            const modalQuestion = document.getElementById('modal-question');
            const modalOptionsContainer = document.getElementById('modal-options');
            const modalCancelButton = document.getElementById('modal-cancel-button');

            function getRoutineData() {
                switch (currentRoutine) {
                    case 'dad':
                        return { tasks: dadTasks, quotes: dadQuotes, mainTitle: "Good Morning!", sidebarTitle: "Dad's Checklist", type: 'list' };
                    case 'kids':
                        return { tasks: kidsTasks, quotes: kidsQuotes, mainTitle: "Let's Get Ready, Superstars!", sidebarTitle: "Gentry's Morning Routine", type: 'list' };
                    case 'chores':
                        return { tasks: choresTasks, quotes: kidsQuotes, mainTitle: "Time to Earn!", sidebarTitle: "Gentry's Chores", type: 'grid' };
                    default:
                        return { tasks: [], quotes: [], mainTitle: "", sidebarTitle: "", type: 'list' };
                }
            }

            function renderSidebar(tasks) {
                checklistListEl.innerHTML = '';
                tasks.forEach((task, index) => {
                    const li = document.createElement('li');
                    const taskText = typeof task === 'object' ? `${task.emoji} ${task.text}` : task;
                    li.textContent = taskText;
                    li.dataset.index = index;
                    li.dataset.routine = currentRoutine;
                    checklistListEl.appendChild(li);
                });
            }
            
            function renderChoreGrid(tasks) {
                currentTaskContainerEl.innerHTML = '<div class="chores-grid" id="chores-grid"></div>';
                const choresGridEl = document.getElementById('chores-grid');
                
                tasks.forEach((chore, index) => {
                    const iconDiv = document.createElement('div');
                    iconDiv.classList.add('chore-icon');
                    iconDiv.dataset.index = index;
                    iconDiv.dataset.amount = chore.amount;
                    iconDiv.innerHTML = `<span>${chore.emoji}</span><p>${chore.text}</p>`;
                    choresGridEl.appendChild(iconDiv);
                });

                choresGridEl.addEventListener('click', handleChoreIconClick);
            }
            
            function handleChoreIconClick(event) {
                let target = event.target.closest('.chore-icon');
                if (!target || target.classList.contains('completed')) return;

                const index = parseInt(target.dataset.index);
                const chore = choresTasks[index]; 
                
                if (chore.isQuantifiable) {
                    showQuantityModal(chore, target);
                } else {
                    const amount = parseFloat(target.dataset.amount);
                    target.dataset.earnedAmount = amount; // Store earned amount
                    completeChore(target, amount);
                }
            }

            function completeChore(targetElement, amount) {
                const index = parseInt(targetElement.dataset.index);
                
                targetElement.classList.add('completed');
                
                const sidebarItem = document.querySelector(`li[data-index="${index}"][data-routine="${currentRoutine}"]`);
                if (sidebarItem) {
                    sidebarItem.classList.add('completed');
                }

                showPaymentMessage(amount);
                createConfetti();
                
                const tasks = getRoutineData().tasks;
                completedChoreCount = document.querySelectorAll('.chore-icon.completed').length;
                if (completedChoreCount === tasks.length) {
                    setTimeout(() => {
                        const totalEarned = Array.from(document.querySelectorAll('.chore-icon.completed')).reduce((sum, icon) => {
                            return sum + (parseFloat(icon.dataset.earnedAmount) || 0);
                        }, 0);

                        alert(`All chores complete! Total earned: $${totalEarned.toFixed(2)}`);
                        
                        currentRoutine = null;
                        currentTaskIndex = 0;
                        quoteShown = false;
                        mainContainer.classList.remove('dad-theme', 'kids-theme');
                        sidebarSection.style.display = 'none';
                        mainContentSection.style.display = 'none';
                        menuSection.style.display = 'flex';
                    }, 1000);
                }
            }

            function showQuantityModal(chore, targetElement) {
                modalQuestion.textContent = chore.question;
                modalOptionsContainer.innerHTML = '';

                chore.options.forEach(number => {
                    const button = document.createElement('button');
                    button.classList.add('modal-option-button');
                    button.textContent = number;
                    button.addEventListener('click', () => {
                        const quantity = parseInt(number);
                        const totalAmount = chore.amount * quantity;
                        targetElement.dataset.earnedAmount = totalAmount; // Store earned amount
                        completeChore(targetElement, totalAmount);
                        hideQuantityModal();
                    });
                    modalOptionsContainer.appendChild(button);
                });
                
                modalOverlay.style.display = 'flex';
            }

            function hideQuantityModal() {
                modalOverlay.style.display = 'none';
            }
            
            // *** MODIFIED: This function now displays dollars and quarters ***
            function showPaymentMessage(amount) {
                const dollars = Math.floor(amount);
                const cents = Math.round((amount - dollars) * 100);
                const quarters = cents / 25;

                let messageParts = [];
                if (dollars > 0) {
                    messageParts.push(`${dollars} üíµ`);
                }
                if (quarters > 0) {
                    messageParts.push(`${quarters} ü™ô`);
                }
                
                const message = messageParts.join(' ');
                
                let paymentDisplay = document.getElementById('payment-display');
                if (!paymentDisplay) {
                    paymentDisplay = document.createElement('div');
                    paymentDisplay.id = 'payment-display';
                    // Append it inside the main content, but after the grid
                    currentTaskContainerEl.appendChild(paymentDisplay);
                }
                
                paymentDisplay.innerHTML = `+ ${message}`;
                paymentDisplay.style.display = 'block';
            }

            function renderCurrentTask() {
                const { tasks, quotes, mainTitle, sidebarTitle, type } = getRoutineData();
                
                mainTitleEl.textContent = mainTitle;
                sidebarTitleEl.textContent = sidebarTitle;
                
                if (type === 'grid') {
                    currentTaskContainerEl.style.display = 'block';
                    sidebarSection.style.display = 'block';
                    renderSidebar(tasks);
                    renderChoreGrid(tasks);
                    return;
                }

                if (!quoteShown) {
                    const randomQuote = quotes[Math.floor(Math.random() * quotes.length)];
                    currentTaskContainerEl.innerHTML = `
                        <p class="task-text text-xl font-medium italic mb-2">"${randomQuote.text}"</p>
                        <p class="text-sm font-light text-gray-600">- ${randomQuote.source}</p>
                        <button class="done-button mt-4">Ready to Start</button>
                    `;
                    quoteShown = true;
                    
                    const doneButton = currentTaskContainerEl.querySelector('.done-button');
                    doneButton.addEventListener('click', handleTaskCompletion);
                } else if (currentTaskIndex < tasks.length) {
                    const currentTask = tasks[currentTaskIndex];
                    const taskText = typeof currentTask === 'object' ? `${currentTask.emoji} ${currentTask.text}` : currentTask;
                    
                    currentTaskContainerEl.innerHTML = '';
                    currentTaskContainerEl.classList.remove('current-task');
                    void currentTaskContainerEl.offsetWidth;
                    currentTaskContainerEl.classList.add('current-task');

                    currentTaskContainerEl.innerHTML = `
                        <p class="task-text">${taskText}</p>
                        <button class="done-button">Done!</button>
                    `;

                    const doneButton = currentTaskContainerEl.querySelector('.done-button');
                    doneButton.addEventListener('click', handleTaskCompletion);
                } else {
                    currentRoutine = null;
                    currentTaskIndex = 0;
                    quoteShown = false;
                    mainContainer.classList.remove('dad-theme', 'kids-theme');
                    sidebarSection.style.display = 'none';
                    mainContentSection.style.display = 'none';
                    menuSection.style.display = 'flex';
                }
            }

            function handleTaskCompletion() {
                const { tasks, type } = getRoutineData();
                
                if (type === 'grid') return;

                if (quoteShown && currentTaskIndex < tasks.length) {
                    const sidebarItem = document.querySelector(`li[data-index="${currentTaskIndex}"][data-routine="${currentRoutine}"]`);
                    if (sidebarItem) {
                        sidebarItem.classList.add('completed');
                    }
                }
                
                if (currentRoutine === 'kids' && currentTaskIndex < tasks.length) {
                    createConfetti();
                }

                if (currentRoutine === 'kids' && typeof tasks[currentTaskIndex] === 'object' && tasks[currentTaskIndex].text === "Take medicine") {
                    showTvBreakScreen();
                } else {
                    currentTaskIndex++;
                    renderCurrentTask();
                }
            }
            
            function createConfetti() {
                const colors = ['#f472b6', '#e879f9', '#c084fc', '#f9a8d4', '#d946ef', '#fbcfe8', '#f0abfc'];
                const confettiCount = 100;
                
                for (let i = 0; i < confettiCount; i++) {
                    const confetti = document.createElement('div');
                    confetti.classList.add('confetti');
                    confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
                    confetti.style.left = `${Math.random() * 100}vw`;
                    confetti.style.animationDelay = `${Math.random() * 0.5}s`;
                    confetti.style.animationDuration = `${Math.random() * 2 + 3}s`;
                    document.body.appendChild(confetti);

                    confetti.addEventListener('animationend', () => {
                        confetti.remove();
                    });
                }
            }

            function showTvBreakScreen() {
                mainContentSection.style.display = 'none';
                tvBreakSectionEl.style.display = 'flex';
            }

            tvBreakDoneButton.addEventListener('click', () => {
                tvBreakSectionEl.style.display = 'none';
                mainContentSection.style.display = 'flex';
                currentTaskIndex++;
                renderCurrentTask();
            });
            
            function startRoutine(routineType, themeClass) {
                currentRoutine = routineType;
                mainContainer.classList.remove('dad-theme', 'kids-theme');
                mainContainer.classList.add(themeClass);
                menuSection.style.display = 'none';
                mainContentSection.style.display = 'flex';
                sidebarSection.style.display = 'block';
                
                currentTaskIndex = 0;
                quoteShown = false;
                completedChoreCount = 0;
                
                const paymentDisplay = document.getElementById('payment-display');
                if (paymentDisplay) paymentDisplay.style.display = 'none';

                renderCurrentTask();
            }

            dadButton.addEventListener('click', () => {
                startRoutine('dad', 'dad-theme');
            });

            gentryButton.addEventListener('click', () => {
                startRoutine('kids', 'kids-theme');
            });
            
            choresButton.addEventListener('click', () => {
                startRoutine('chores', 'kids-theme');
            });

            modalCancelButton.addEventListener('click', hideQuantityModal);
            modalOverlay.addEventListener('click', (event) => {
                if (event.target === modalOverlay) {
                    hideQuantityModal();
                }
            });
        });
    </script>
</body>
</html>

